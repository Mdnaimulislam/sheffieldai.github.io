name: updatedata

on: workflow_dispatch

jobs:
  updatedata:
    name: Update data
    runs-on: ${{ matrix.os }}
    strategy:
      matrix:
        os: [ubuntu-latest]
        python-version: [3.7]
    steps:
      - uses: actions/checkout@v2
      - name: Set up Python using Miniconda
        uses: conda-incubator/setup-miniconda@v2
        with:
          auto-update-conda: true
          python-version: ${{ matrix.python-version }}
      - name: Install dependencies
        run: |
          pip install --upgrade google-api-python-client google-auth-httplib2 google-auth-oauthlib
        shell: bash -l {0}
      - name: Download data from google drive
        env:
          TOKEN: ${{ secrets.TOKEN }}
          REFRESH_TOKEN: ${{ secrets.REFRESH_TOKEN }}
          CLIENT_ID: ${{ secrets.CLIENT_ID }}
          CLIENT_SECRET: ${{ secrets.CLIENT_SECRET }}
          FILE_ID: ${{ secrets.FILE_ID }}
        run: |
          echo env.FILE_ID
          python tools/download_from_drive.py --token env.TOKEN --refresh_token env.REFRESH_TOKEN --client_id env.CLIENT_ID --client_secret env.CLIENT_SECRET --file_id env.FILE_ID --output_path "./test.csv"
        shell: bash -l {0}
